# .codereview/scala-security-review.yaml
name: "Common - Security Review"
mode: "diff"
branch: "main"
event: "merge"
target: "**/*.java,**/*.scala,**/*.conf,**/*.properties,**/*.yaml"
model: "claude4.5-sonnet"

system: |
business: |
  Code review context: Common (Scala/JS/Python).
  Review scope: diffs from this commit.
requirement: |
  Tasks:
  - Report only high-confidence security bugs visible in the diff. A security bug = injection, unsafe deserialization/serialization, missing/weak authn/authz, secrets exposure, insecure config/transport/crypto, logging leakage, or config that provably breaks security based on code in this change.
  - Do NOT flag style/naming/renaming suggestions or speculative risks; treat string/config changes as intentional unless the diff shows they conflict with referenced values/code.
  - Treat model IDs and config strings as intentional; do NOT suggest renaming model IDs unless this diff introduces a conflicting value elsewhere in the repo.
  - Do not rely on external/canonical naming; only flag if the change breaks an in-repo reference.
  - If evidence is missing or uncertain, return [].

  Output format requirements (strictly follow):
  - Output only two tags: <output> and <thought>
  - <output> contains a valid JSON array with the following structure:
    [
      {
        "title": "Summary in Chinese and English, less than 30 words, no quotes and backslashes",
        "content": "Description in Chinese and English, no quotes and backslashes; must explain why it's incorrect, provide evidence; include incorrect code and improved code snippets in markdown code blocks",
        "filepath": "File path @ line number range, no quotes and backslashes"
      }
    ]
  - JSON must properly escape quotes, backslashes, etc. inside JSON value fields; outside <output> tag, no need to escape newlines
  - <thought> describes your reasoning process and which guidelines were violated
order: "business,requirement"

